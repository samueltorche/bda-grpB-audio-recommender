{"paragraphs":[{"text":"%md\n# MBA with audioscrobbler\n## imports","user":"anonymous","dateUpdated":"2020-06-05T11:19:49+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>MBA with audioscrobbler</h1>\n<h2>imports</h2>\n</div>"}]},"apps":[],"jobName":"paragraph_1590749114709_2034108693","id":"20200529-104514_1832634434","dateCreated":"2020-05-29T10:45:14+0000","dateStarted":"2020-06-05T11:19:49+0000","dateFinished":"2020-06-05T11:19:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:8785"},{"text":"import org.apache.spark.sql.Dataset\nimport org.apache.spark.sql.Row\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types._\nimport scala.util.Random\nimport org.apache.spark.mllib.fpm.AssociationRules\nimport org.apache.spark.ml.fpm.FPGrowth\n\nspark.conf.set(\"spark.sql.pivotMaxValues\", 2000000)","user":"anonymous","dateUpdated":"2020-06-05T11:19:50+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.sql.Dataset\nimport org.apache.spark.sql.Row\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types._\nimport scala.util.Random\nimport org.apache.spark.mllib.fpm.AssociationRules\nimport org.apache.spark.ml.fpm.FPGrowth\n"}]},"apps":[],"jobName":"paragraph_1590749036482_-1759570951","id":"20200529-104356_357249297","dateCreated":"2020-05-29T10:43:56+0000","dateStarted":"2020-06-05T11:19:50+0000","dateFinished":"2020-06-05T11:19:50+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8786"},{"text":"%md\n# Load data","user":"anonymous","dateUpdated":"2020-06-05T11:19:50+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false,"completionKey":"TAB"},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>Load data</h1>\n</div>"}]},"apps":[],"jobName":"paragraph_1590749059460_648103850","id":"20200529-104419_1869762308","dateCreated":"2020-05-29T10:44:19+0000","dateStarted":"2020-06-05T11:19:50+0000","dateFinished":"2020-06-05T11:19:50+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8787"},{"text":"// Load the play count schema\nval rawPlayCounts = spark.sparkContext.textFile(\"/data/user_artist_data.txt\")\nval rawArtistData = spark.sparkContext.textFile(\"/data/artist_data.txt\")\nval rawArtistAlias = spark.sparkContext.textFile(\"/data/artist_alias.txt\")\nrawPlayCounts.take(5).foreach(println)","user":"anonymous","dateUpdated":"2020-06-05T11:19:50+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","editorHide":false,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"1000002 1 55\n1000002 1000006 33\n1000002 1000007 8\n1000002 1000009 144\n1000002 1000010 314\nrawPlayCounts: org.apache.spark.rdd.RDD[String] = /data/user_artist_data.txt MapPartitionsRDD[92] at textFile at <console>:48\nrawArtistData: org.apache.spark.rdd.RDD[String] = /data/artist_data.txt MapPartitionsRDD[94] at textFile at <console>:49\nrawArtistAlias: org.apache.spark.rdd.RDD[String] = /data/artist_alias.txt MapPartitionsRDD[96] at textFile at <console>:50\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=16"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1590749194903_-1488373091","id":"20200529-104634_2049879777","dateCreated":"2020-05-29T10:46:34+0000","dateStarted":"2020-06-05T11:19:50+0000","dateFinished":"2020-06-05T11:19:52+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8788"},{"text":"%md\n## Convert to DataSet","user":"anonymous","dateUpdated":"2020-06-05T11:19:52+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Convert to DataSet</h2>\n</div>"}]},"apps":[],"jobName":"paragraph_1590749241759_-1847855583","id":"20200529-104721_2063844306","dateCreated":"2020-05-29T10:47:21+0000","dateStarted":"2020-06-05T11:19:52+0000","dateFinished":"2020-06-05T11:19:52+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8789"},{"text":"val artistByID = rawArtistData.flatMap { line =>\n    val (id, name) = line.span(_ != '\\t')\n    if (name.isEmpty()){\n        None\n    } else {\n        try {\n            Some((id.toInt, name.trim))\n        } catch{\n            case _: NumberFormatException => None\n        }\n  }\n}.toDF(\"id\", \"name\").cache()","user":"anonymous","dateUpdated":"2020-06-05T11:19:52+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"artistByID: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [id: int, name: string]\n"}]},"apps":[],"jobName":"paragraph_1590750341363_930356056","id":"20200529-110541_825106953","dateCreated":"2020-05-29T11:05:41+0000","dateStarted":"2020-06-05T11:19:52+0000","dateFinished":"2020-06-05T11:19:54+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8790"},{"text":"val artistAlias = rawArtistAlias.flatMap { line =>\n      var Array(artist, alias) = line.split('\\t')\n      if (artist.isEmpty()) {\n        None\n      } else {\n        Some((artist.toInt, alias.toInt))\n      }\n}.collect().toMap\nval bArtistAlias = spark.sparkContext.broadcast(artistAlias)","user":"anonymous","dateUpdated":"2020-06-05T11:19:54+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"artistAlias: scala.collection.immutable.Map[Int,Int] = Map(1208690 -> 1003926, 2012757 -> 4569, 6949139 -> 1085752, 1109727 -> 1239120, 6772751 -> 1244705, 2070533 -> 1021544, 1157679 -> 2194, 9969617 -> 5630, 2034496 -> 1116214, 6764342 -> 40, 1272489 -> 1278238, 2108744 -> 1009267, 10349857 -> 1000052, 2145319 -> 1020463, 2126338 -> 2717, 10165456 -> 1001169, 6779368 -> 1239506, 10278137 -> 1001523, 9939075 -> 1329390, 2037201 -> 1274155, 1248585 -> 2885, 1106945 -> 1399, 6811322 -> 1019016, 9978396 -> 1784, 6676961 -> 1086433, 2117821 -> 2611, 6863616 -> 1277013, 6895480 -> 1000993, 6831632 -> 1246136, 1001719 -> 1009727, 10135633 -> 4250, 7029291 -> 1034635, 6967939 -> 1002734, 6864694 -> 1017311, 1237279 -> 1029752, 6793956 -> 1283231, 1208609 -> 1000699, 6693428 -> 1100258, 685174..."}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=17"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1590751073512_1241446847","id":"20200529-111753_1097578992","dateCreated":"2020-05-29T11:17:53+0000","dateStarted":"2020-06-05T11:19:54+0000","dateFinished":"2020-06-05T11:19:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8791"},{"text":"val userArtist = rawPlayCounts.map { line =>\n    val Array(userId, artistID, count) = line.split(' ').map(_.toInt)\n    val finalArtistID = bArtistAlias.value.getOrElse(artistID, artistID)\n    (userId, artistID, count)\n}.toDF(\"user\", \"artist\", \"count\")\n\nuserArtist.show(5)\n\n// val userArtistDF = userArtist.join(artistByID, userArtist.col(\"artist\") === artistByID.col(\"id\")).select(\"user\", \"name\", \"count\").withColumnRenamed(\"name\", \"artist\")\nval userArtistDF = userArtist\n\nuserArtistDF.show(5)\n           \nuserArtistDF.cache()","user":"anonymous","dateUpdated":"2020-06-05T11:19:57+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+-------+-----+\n|   user| artist|count|\n+-------+-------+-----+\n|1000002|      1|   55|\n|1000002|1000006|   33|\n|1000002|1000007|    8|\n|1000002|1000009|  144|\n|1000002|1000010|  314|\n+-------+-------+-----+\nonly showing top 5 rows\n\n+-------+-------+-----+\n|   user| artist|count|\n+-------+-------+-----+\n|1000002|      1|   55|\n|1000002|1000006|   33|\n|1000002|1000007|    8|\n|1000002|1000009|  144|\n|1000002|1000010|  314|\n+-------+-------+-----+\nonly showing top 5 rows\n\nuserArtist: org.apache.spark.sql.DataFrame = [user: int, artist: int ... 1 more field]\nuserArtistDF: org.apache.spark.sql.DataFrame = [user: int, artist: int ... 1 more field]\nres9: userArtistDF.type = [user: int, artist: int ... 1 more field]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=18","http://172.17.0.2:4040/jobs/job?id=19"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1590751693610_977194535","id":"20200529-112813_127150251","dateCreated":"2020-05-29T11:28:13+0000","dateStarted":"2020-06-05T11:19:58+0000","dateFinished":"2020-06-05T11:20:01+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8792"},{"text":"%md\n# Create transactions","user":"anonymous","dateUpdated":"2020-06-05T11:20:01+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>Create transactions</h1>\n</div>"}]},"apps":[],"jobName":"paragraph_1590750459925_1348152663","id":"20200529-110739_1451215536","dateCreated":"2020-05-29T11:07:39+0000","dateStarted":"2020-06-05T11:20:02+0000","dateFinished":"2020-06-05T11:20:02+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8793"},{"text":"%md\n### Create subset of data","user":"anonymous","dateUpdated":"2020-06-05T11:20:02+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Create subset of data</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1591350613352_-1039824011","id":"20200605-095013_1690233988","dateCreated":"2020-06-05T09:50:13+0000","dateStarted":"2020-06-05T11:20:02+0000","dateFinished":"2020-06-05T11:20:02+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8794"},{"text":"val userArtistSubsetDF = userArtistDF.limit(5000000)\nval transactions = userArtistSubsetDF.withColumn(\"combined\", $\"artist\").groupBy(\"user\").agg(collect_list($\"combined\").alias(\"items\"))\ntransactions.cache()\ntransactions.show(10)\ntransactions.count()","user":"anonymous","dateUpdated":"2020-06-05T11:20:02+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----+--------------------+\n| user|               items|\n+-----+--------------------+\n| 1014|[1000382, 1000416...|\n|10015|[1000188, 1000201...|\n|10016|[1, 1000010, 1000...|\n|10025|[1007505, 1009401...|\n|10027|[1000241, 1000429...|\n|10103|[1000010, 1000062...|\n|10137|[1000591, 1000822...|\n|10142|[1000130, 1000192...|\n|10201|[1000429, 1004241...|\n|10211|[1000014, 1000024...|\n+-----+--------------------+\nonly showing top 10 rows\n\nuserArtistSubsetDF: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [user: int, artist: int ... 1 more field]\ntransactions: org.apache.spark.sql.DataFrame = [user: int, items: array<int>]\nres10: Long = 21117\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=20","http://172.17.0.2:4040/jobs/job?id=21"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1591350239973_-644902498","id":"20200605-094359_678083187","dateCreated":"2020-06-05T09:43:59+0000","dateStarted":"2020-06-05T11:20:02+0000","dateFinished":"2020-06-05T11:21:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8795"},{"text":"%md\n## Create FPGrowth model for frequent pattern mining","user":"anonymous","dateUpdated":"2020-06-05T11:21:47+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Create FPGrowth model for frequent pattern mining</h2>\n</div>"}]},"apps":[],"jobName":"paragraph_1590750858376_995039256","id":"20200529-111418_2096367753","dateCreated":"2020-05-29T11:14:18+0000","dateStarted":"2020-06-05T11:21:47+0000","dateFinished":"2020-06-05T11:21:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8796"},{"text":"transactions.count()\nval fpgrowth = new FPGrowth().setItemsCol(\"items\").setMinSupport(0.1).setMinConfidence(0.1)\nval model = fpgrowth.fit(transactions)\n","user":"anonymous","dateUpdated":"2020-06-05T11:21:47+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"fpgrowth: org.apache.spark.ml.fpm.FPGrowth = fpgrowth_bbf2ce2485f6\nmodel: org.apache.spark.ml.fpm.FPGrowthModel = fpgrowth_bbf2ce2485f6\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=22","http://172.17.0.2:4040/jobs/job?id=23","http://172.17.0.2:4040/jobs/job?id=24"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1590750880281_-470861645","id":"20200529-111440_895362572","dateCreated":"2020-05-29T11:14:40+0000","dateStarted":"2020-06-05T11:21:47+0000","dateFinished":"2020-06-05T11:21:55+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8797"},{"text":"%md\n## Frequent items sets","user":"anonymous","dateUpdated":"2020-06-05T11:21:55+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Frequent items sets</h2>\n</div>"}]},"apps":[],"jobName":"paragraph_1590936910680_753181140","id":"20200531-145510_333750401","dateCreated":"2020-05-31T14:55:10+0000","dateStarted":"2020-06-05T11:21:55+0000","dateFinished":"2020-06-05T11:21:55+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8798"},{"text":"val freqItems = model.freqItemsets\nfreqItems.cache()\n\nfreqItems.show(5)\nfreqItems.count()","user":"anonymous","dateUpdated":"2020-06-05T11:21:55+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---------+----+\n|    items|freq|\n+---------+----+\n|[1000481]|2481|\n|[1000557]|2378|\n|      [1]|2956|\n| [1, 979]|2242|\n|     [78]|2812|\n+---------+----+\nonly showing top 5 rows\n\nfreqItems: org.apache.spark.sql.DataFrame = [items: array<int>, freq: bigint]\nres11: Long = 879\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=25","http://172.17.0.2:4040/jobs/job?id=26"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1591267780338_1292045914","id":"20200604-104940_1657700352","dateCreated":"2020-06-04T10:49:40+0000","dateStarted":"2020-06-05T11:21:55+0000","dateFinished":"2020-06-05T11:22:24+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8799"},{"text":"%md\n### Association rules","user":"anonymous","dateUpdated":"2020-06-05T11:22:24+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Association rules</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1591353073692_-479159543","id":"20200605-103113_142095309","dateCreated":"2020-06-05T10:31:13+0000","dateStarted":"2020-06-05T11:22:24+0000","dateFinished":"2020-06-05T11:22:24+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8800"},{"text":"%spark\n// Display generated association rules.\nval associationRules = model.associationRules\nassociationRules.cache()\nassociationRules.show(10)\nassociationRules.count()","user":"anonymous","dateUpdated":"2020-06-05T12:19:14+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------+----------+-------------------+\n|antecedent|consequent|         confidence|\n+----------+----------+-------------------+\n|[82, 1177]|     [979]| 0.8079347423062663|\n| [1001412]| [1000123]|0.49250771264874393|\n| [1001412]| [1000052]| 0.5176289114147201|\n| [1001412]| [1000062]| 0.5288673424416043|\n| [1001412]|     [976]| 0.5533274570295285|\n+----------+----------+-------------------+\nonly showing top 5 rows\n\nassociationRules: org.apache.spark.sql.DataFrame = [antecedent: array<int>, consequent: array<int> ... 1 more field]\nres13: Long = 1470\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=27","http://172.17.0.2:4040/jobs/job?id=28"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1591268078316_1058846978","id":"20200604-105438_1198090082","dateCreated":"2020-06-04T10:54:38+0000","dateStarted":"2020-06-05T11:22:24+0000","dateFinished":"2020-06-05T11:22:26+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8801"},{"text":"//show association rules with artist name instead of id\nassociationRules.\n    sort($\"confidence\".desc).\n    limit(10).\n    withColumn(\"antecedent\", concat_ws(\",\", $\"antecedent\")).\n    withColumn(\"consequent\", concat_ws(\",\", $\"consequent\")).\n    collect().foreach { row =>\n        println(row)\n        val ante = row.get(0).toString()\n        val conse = row.get(1).toString()\n        val ante_array = ante.split(\",\").map(_.toInt)\n        val conse_array = conse.split(\",\").map(_.toInt)\n        for(i <- 0 until ante_array.length) {\n            val name = artistByID.filter(artistByID(\"id\").equalTo(ante_array(i))).select(\"name\").collectAsList().get(0).get(0)\n            print(name + \", \")\n        }\n        print(\" -> \")\n        for(i <- 0 until conse_array.length) {\n            val name = artistByID.filter(artistByID(\"id\").equalTo(conse_array(i))).select(\"name\").collectAsList().get(0).get(0)\n            print(name)\n        }\n        print(\"\\n\")\n}","user":"anonymous","dateUpdated":"2020-06-05T12:28:23+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[352,1177,979,0.8645339652448657]\nBeck, Coldplay,  -> Radiohead\n[352,1307,979,0.843316144387148]\nBeck, The White Stripes,  -> Radiohead\n[1001646,1177,979,0.8378378378378378]\nThe Smashing Pumpkins, Coldplay,  -> Radiohead\n[352,3327,979,0.8362779740871613]\nBeck, Weezer,  -> Radiohead\n[1001646,1307,979,0.8283378746594006]\nThe Smashing Pumpkins, The White Stripes,  -> Radiohead\n[1001646,1275996,979,0.8282633808240277]\nThe Smashing Pumpkins, R.E.M.,  -> Radiohead\n[234,1000113,979,0.823134328358209]\nPixies, The Beatles,  -> Radiohead\n[1001779,1000113,979,0.8190219484020023]\nModest Mouse, The Beatles,  -> Radiohead\n[352,1000113,979,0.8182748039549949]\nBeck, The Beatles,  -> Radiohead\n[1001646,1000113,979,0.8157984337759618]\nThe Smashing Pumpkins, The Beatles,  -> Radiohead\n"}]},"apps":[],"jobName":"paragraph_1591353121713_-2053493584","id":"20200605-103201_86989224","dateCreated":"2020-06-05T10:32:01+0000","dateStarted":"2020-06-05T12:28:23+0000","dateFinished":"2020-06-05T12:28:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8802","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=2768","http://172.17.0.2:4040/jobs/job?id=2769","http://172.17.0.2:4040/jobs/job?id=2770","http://172.17.0.2:4040/jobs/job?id=2771","http://172.17.0.2:4040/jobs/job?id=2772","http://172.17.0.2:4040/jobs/job?id=2773","http://172.17.0.2:4040/jobs/job?id=2774","http://172.17.0.2:4040/jobs/job?id=2775","http://172.17.0.2:4040/jobs/job?id=2776","http://172.17.0.2:4040/jobs/job?id=2777","http://172.17.0.2:4040/jobs/job?id=2778","http://172.17.0.2:4040/jobs/job?id=2779","http://172.17.0.2:4040/jobs/job?id=2780","http://172.17.0.2:4040/jobs/job?id=2781","http://172.17.0.2:4040/jobs/job?id=2782","http://172.17.0.2:4040/jobs/job?id=2783","http://172.17.0.2:4040/jobs/job?id=2784","http://172.17.0.2:4040/jobs/job?id=2785","http://172.17.0.2:4040/jobs/job?id=2786","http://172.17.0.2:4040/jobs/job?id=2787","http://172.17.0.2:4040/jobs/job?id=2788","http://172.17.0.2:4040/jobs/job?id=2789","http://172.17.0.2:4040/jobs/job?id=2790","http://172.17.0.2:4040/jobs/job?id=2791","http://172.17.0.2:4040/jobs/job?id=2792","http://172.17.0.2:4040/jobs/job?id=2793","http://172.17.0.2:4040/jobs/job?id=2794","http://172.17.0.2:4040/jobs/job?id=2795","http://172.17.0.2:4040/jobs/job?id=2796","http://172.17.0.2:4040/jobs/job?id=2797","http://172.17.0.2:4040/jobs/job?id=2798"],"interpreterSettingId":"spark"}}},{"user":"anonymous","dateUpdated":"2020-06-05T11:22:27+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1591354178853_-1002192343","id":"20200605-104938_1494816801","dateCreated":"2020-06-05T10:49:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8803"}],"name":"MBA_audioscrobbler","id":"2F9SCURCS","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}