{"paragraphs":[{"text":"%md\n# MBA with audioscrobbler\n## imports","user":"anonymous","dateUpdated":"2020-06-04T11:17:42+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>MBA with audioscrobbler</h1>\n<h2>imports</h2>\n</div>"}]},"apps":[],"jobName":"paragraph_1590749114709_2034108693","id":"20200529-104514_1832634434","dateCreated":"2020-05-29T10:45:14+0000","dateStarted":"2020-06-04T11:17:42+0000","dateFinished":"2020-06-04T11:17:42+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:273"},{"text":"import org.apache.spark.sql.Dataset\nimport org.apache.spark.sql.Row\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types._\nimport scala.util.Random\nimport org.apache.spark.mllib.fpm.AssociationRules\nimport org.apache.spark.ml.fpm.FPGrowth","user":"anonymous","dateUpdated":"2020-06-04T11:17:42+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.sql.Dataset\nimport org.apache.spark.sql.Row\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types._\nimport scala.util.Random\nimport org.apache.spark.mllib.fpm.AssociationRules\nimport org.apache.spark.ml.fpm.FPGrowth\n"}]},"apps":[],"jobName":"paragraph_1590749036482_-1759570951","id":"20200529-104356_357249297","dateCreated":"2020-05-29T10:43:56+0000","dateStarted":"2020-06-04T11:17:42+0000","dateFinished":"2020-06-04T11:18:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:274"},{"text":"%md\n# Load data","user":"anonymous","dateUpdated":"2020-06-04T11:18:03+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false,"completionKey":"TAB"},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>Load data</h1>\n</div>"}]},"apps":[],"jobName":"paragraph_1590749059460_648103850","id":"20200529-104419_1869762308","dateCreated":"2020-05-29T10:44:19+0000","dateStarted":"2020-06-04T11:18:03+0000","dateFinished":"2020-06-04T11:18:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:275"},{"text":"// Load the play count schema\nval rawPlayCounts = spark.sparkContext.textFile(\"/data/user_artist_data.txt\")\nval rawArtistData = spark.sparkContext.textFile(\"/data/artist_data.txt\")\nval rawArtistAlias = spark.sparkContext.textFile(\"/data/artist_alias.txt\")\nrawPlayCounts.take(5).foreach(println)","user":"anonymous","dateUpdated":"2020-06-04T11:18:03+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","editorHide":false,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"1000002 1 55\n1000002 1000006 33\n1000002 1000007 8\n1000002 1000009 144\n1000002 1000010 314\nrawPlayCounts: org.apache.spark.rdd.RDD[String] = /data/user_artist_data.txt MapPartitionsRDD[1] at textFile at <console>:35\nrawArtistData: org.apache.spark.rdd.RDD[String] = /data/artist_data.txt MapPartitionsRDD[3] at textFile at <console>:36\nrawArtistAlias: org.apache.spark.rdd.RDD[String] = /data/artist_alias.txt MapPartitionsRDD[5] at textFile at <console>:37\n"}]},"apps":[],"jobName":"paragraph_1590749194903_-1488373091","id":"20200529-104634_2049879777","dateCreated":"2020-05-29T10:46:34+0000","dateStarted":"2020-06-04T11:18:04+0000","dateFinished":"2020-06-04T11:18:08+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:276","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=0"],"interpreterSettingId":"spark"}}},{"text":"%md\n## Convert to DataSet","user":"anonymous","dateUpdated":"2020-06-04T11:18:08+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Convert to DataSet</h2>\n</div>"}]},"apps":[],"jobName":"paragraph_1590749241759_-1847855583","id":"20200529-104721_2063844306","dateCreated":"2020-05-29T10:47:21+0000","dateStarted":"2020-06-04T11:18:08+0000","dateFinished":"2020-06-04T11:18:08+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:277"},{"text":"val artistByID = rawArtistData.flatMap { line =>\n    val (id, name) = line.span(_ != '\\t')\n    if (name.isEmpty()){\n        None\n    } else {\n        try {\n            Some((id.toInt, name.trim))\n        } catch{\n            case _: NumberFormatException => None\n        }\n  }\n}.toDF(\"id\", \"name\").cache()","user":"anonymous","dateUpdated":"2020-06-04T11:18:08+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"artistByID: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [id: int, name: string]\n"}]},"apps":[],"jobName":"paragraph_1590750341363_930356056","id":"20200529-110541_825106953","dateCreated":"2020-05-29T11:05:41+0000","dateStarted":"2020-06-04T11:18:08+0000","dateFinished":"2020-06-04T11:18:12+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:278"},{"text":"val artistAlias = rawArtistAlias.flatMap { line =>\n      var Array(artist, alias) = line.split('\\t')\n      if (artist.isEmpty()) {\n        None\n      } else {\n        Some((artist.toInt, alias.toInt))\n      }\n}.collect().toMap\nval bArtistAlias = spark.sparkContext.broadcast(artistAlias)","user":"anonymous","dateUpdated":"2020-06-04T11:18:12+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"artistAlias: scala.collection.immutable.Map[Int,Int] = Map(1208690 -> 1003926, 2012757 -> 4569, 6949139 -> 1085752, 1109727 -> 1239120, 6772751 -> 1244705, 2070533 -> 1021544, 1157679 -> 2194, 9969617 -> 5630, 2034496 -> 1116214, 6764342 -> 40, 1272489 -> 1278238, 2108744 -> 1009267, 10349857 -> 1000052, 2145319 -> 1020463, 2126338 -> 2717, 10165456 -> 1001169, 6779368 -> 1239506, 10278137 -> 1001523, 9939075 -> 1329390, 2037201 -> 1274155, 1248585 -> 2885, 1106945 -> 1399, 6811322 -> 1019016, 9978396 -> 1784, 6676961 -> 1086433, 2117821 -> 2611, 6863616 -> 1277013, 6895480 -> 1000993, 6831632 -> 1246136, 1001719 -> 1009727, 10135633 -> 4250, 7029291 -> 1034635, 6967939 -> 1002734, 6864694 -> 1017311, 1237279 -> 1029752, 6793956 -> 1283231, 1208609 -> 1000699, 6693428 -> 1100258, 685174..."}]},"apps":[],"jobName":"paragraph_1590751073512_1241446847","id":"20200529-111753_1097578992","dateCreated":"2020-05-29T11:17:53+0000","dateStarted":"2020-06-04T11:18:12+0000","dateFinished":"2020-06-04T11:18:15+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:279","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=1"],"interpreterSettingId":"spark"}}},{"text":"val userArtistDF = rawPlayCounts.map { line =>\n    val Array(userId, artistID, count) = line.split(' ').map(_.toInt)\n    val finalArtistID = bArtistAlias.value.getOrElse(artistID, artistID)\n    (userId, artistID, count)\n}.toDF(\"user\", \"artist\", \"count\").cache()\n\nuserArtistDF.show(5)","user":"anonymous","dateUpdated":"2020-06-04T11:18:15+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+-------+-----+\n|   user| artist|count|\n+-------+-------+-----+\n|1000002|      1|   55|\n|1000002|1000006|   33|\n|1000002|1000007|    8|\n|1000002|1000009|  144|\n|1000002|1000010|  314|\n+-------+-------+-----+\nonly showing top 5 rows\n\nuserArtistDF: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [user: int, artist: int ... 1 more field]\n"}]},"apps":[],"jobName":"paragraph_1590751693610_977194535","id":"20200529-112813_127150251","dateCreated":"2020-05-29T11:28:13+0000","dateStarted":"2020-06-04T11:18:15+0000","dateFinished":"2020-06-04T11:18:23+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:280","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=2"],"interpreterSettingId":"spark"}}},{"text":"%md\n# Create transactions","user":"anonymous","dateUpdated":"2020-06-04T11:18:24+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1590750459925_1348152663","id":"20200529-110739_1451215536","dateCreated":"2020-05-29T11:07:39+0000","dateStarted":"2020-06-04T11:18:24+0000","dateFinished":"2020-06-04T11:18:24+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:281","errorMessage":""},{"text":"spark.conf.set(\"spark.sql.pivotMaxValues\", 2000000)\n\nval userArtistSubsetDF = userArtistDF.limit(1000).cache()\nval transactions = userArtistSubsetDF.groupBy(\"user\").pivot(\"artist\").max(\"artist\").cache()\ntransactions.show(1)","user":"anonymous","dateUpdated":"2020-06-04T11:18:24+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","editorHide":false,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+--------+\n|   user|  1| 18| 28| 30| 59| 78| 82|101|106|121|202|228|231|237|238|242|250|313|344|357|360|388|393|395|402|407|421|478|532|542|553|599|600|606|619|648|657|658|666|668|671|672|688|691|709|715|719|721|723|725|733|735|740|742|758|776|782|793|831|833|860|893|930|949|958|969|976|979|988|999|1018|1024|1169|1171|1177|1183|1187|1194|1195|1196|1197|1198|1199|1200|1201|1204|1212|1223|1224|1226|1230|1251|1262|1263|1265|1270|1274|1289|1303|1305|1327|1330|1394|1399|1403|1410|1413|1414|1428|1441|1444|1448|1462|1495|1501|1516|1520|1570|1779|1789|1805|1825|1835|1844|1854|1858|1864|1890|1967|2077|2085|2167|2171|2184|2194|2600|2617|2621|2636|2712|2717|2823|2842|2860|2883|2884|2897|2916|2951|2955|3007|3009|3033|3083|3085|3122|3123|3150|3170|3197|3287|3292|3296|3314|3316|3321|3327|3328|3379|3402|3408|3418|3427|3437|3491|3547|3554|3625|3656|3677|3727|3902|3941|3985|4019|4083|4137|4154|4156|4195|4209|4221|4224|4241|4246|4250|4267|4324|4341|4371|4377|4468|4538|4567|4569|4775|5097|5153|5372|5376|5409|5452|5453|5496|5606|5626|5661|5668|5687|5702|5705|5712|5734|5761|1000006|1000007|1000009|1000010|1000013|1000014|1000017|1000024|1000025|1000028|1000031|1000033|1000036|1000042|1000045|1000054|1000055|1000056|1000059|1000062|1000069|1000071|1000076|1000080|1000087|1000088|1000094|1000099|1000107|1000108|1000112|1000113|1000120|1000123|1000124|1000127|1000130|1000137|1000139|1000140|1000157|1000162|1000166|1000175|1000176|1000183|1000188|1000200|1000201|1000209|1000210|1000230|1000236|1000243|1000251|1000260|1000265|1000266|1000277|1000283|1000284|1000287|1000288|1000289|1000293|1000295|1000301|1000302|1000305|1000315|1000317|1000321|1000322|1000323|1000325|1000329|1000331|1000336|1000339|1000340|1000342|1000343|1000382|1000383|1000386|1000390|1000412|1000414|1000416|1000418|1000422|1000424|1000427|1000429|1000431|1000434|1000435|1000438|1000440|1000441|1000442|1000444|1000446|1000449|1000450|1000451|1000455|1000456|1000457|1000458|1000467|1000468|1000472|1000473|1000481|1000482|1000485|1000498|1000503|1000511|1000512|1000515|1000518|1000520|1000522|1000525|1000527|1000535|1000538|1000542|1000543|1000562|1000565|1000567|1000569|1000570|1000573|1000582|1000584|1000586|1000589|1000591|1000594|1000597|1000598|1000616|1000620|1000623|1000624|1000625|1000630|1000631|1000632|1000636|1000639|1000642|1000644|1000650|1000651|1000653|1000655|1000656|1000660|1000674|1000676|1000677|1000689|1000691|1000693|1000698|1000700|1000701|1000711|1000712|1000716|1000717|1000721|1000724|1000726|1000727|1000730|1000737|1000738|1000740|1000744|1000751|1000752|1000759|1000761|1000762|1000763|1000764|1000765|1000766|1000768|1000773|1000777|1000781|1000786|1000787|1000789|1000790|1000792|1000795|1000796|1000799|1000808|1000813|1000815|1000817|1000820|1000836|1000839|1000840|1000841|1000848|1000853|1000855|1000863|1000874|1000881|1000889|1000896|1000899|1000904|1000923|1000928|1000931|1000933|1000943|1000946|1000947|1000949|1000951|1000956|1000957|1000959|1000967|1000970|1000971|1000972|1000973|1000981|1000982|1000985|1001007|1001008|1001065|1001129|1001130|1001152|1001167|1001172|1001174|1001178|1001180|1001207|1001208|1001220|1001223|1001229|1001230|1001233|1001240|1001249|1001261|1001265|1001270|1001273|1001276|1001281|1001291|1001292|1001293|1001294|1001295|1001296|1001300|1001302|1001304|1001306|1001307|1001310|1001313|1001320|1001327|1001328|1001329|1001332|1001333|1001341|1001342|1001343|1001345|1001346|1001347|1001348|1001351|1001352|1001353|1001355|1001358|1001362|1001363|1001380|1001402|1001410|1001426|1001478|1001483|1001528|1001529|1001531|1001550|1001551|1001646|1001653|1001674|1001708|1001727|1001757|1001804|1001807|1001812|1001835|1001836|1001855|1001858|1001888|1001900|1001910|1001920|1001989|1002098|1002178|1002214|1002287|1002382|1002401|1002439|1002457|1002498|1002517|1002556|1002577|1002586|1002615|1002624|1002732|1002736|1002794|1002801|1002802|1002837|1002852|1002909|1002914|1002915|1002916|1003030|1003039|1003069|1003083|1003084|1003158|1003159|1003168|1003212|1003263|1003265|1003342|1003365|1003367|1003369|1003370|1003371|1003373|1003376|1003377|1003378|1003379|1003380|1003381|1003382|1003383|1003384|1003386|1003387|1003388|1003389|1003391|1003394|1003395|1003396|1003397|1003398|1003402|1003404|1003405|1003406|1003408|1003409|1003410|1003411|1003412|1003413|1003414|1003415|1003416|1003417|1003418|1003419|1003420|1003421|1003422|1003424|1003433|1003472|1003475|1003477|1003478|1003483|1003484|1003488|1003489|1003493|1003495|1003497|1003501|1003511|1003514|1003515|1003517|1003518|1003519|1003520|1003522|1003523|1003524|1003526|1003527|1003557|1003579|1003610|1003612|1003615|1003616|1003617|1003619|1003620|1003622|1003623|1003627|1003628|1003631|1003632|1003633|1003634|1003637|1003640|1003643|1003646|1003647|1003648|1003649|1003650|1003654|1003655|1003657|1003673|1003700|1003731|1003778|1003886|1003926|1003944|1003988|1003994|1004039|1004055|1004058|1004082|1004130|1004216|1004245|1004308|1004309|1004312|1004315|1004316|1004323|1004326|1004334|1004336|1004338|1004339|1004346|1004349|1004351|1004352|1004355|1004359|1004362|1004365|1004369|1004370|1004371|1004373|1004375|1004378|1004380|1004381|1004384|1004386|1004391|1004393|1004394|1004395|1004398|1004401|1004406|1004628|1004629|1004637|1005059|1005308|1005365|1005370|1005374|1005375|1005377|1005615|1005729|1005749|1005915|1005945|1006094|1006102|1006174|1006304|1006332|1006379|1006381|1006385|1006392|1006399|1006404|1006410|1006412|1006418|1006846|1006896|1007045|1007346|1007347|1007430|1007459|1007603|1007652|1007653|1007744|1007753|1007756|1007757|1007972|1008016|1008136|1008164|1008850|1009024|1009065|1009243|1009786|1009970|1010005|1010022|1010076|1010093|1010143|1010152|1010160|1010219|1010683|1011814|1012807|1014033|1014120|1014133|1014421|1014463|1014481|1015265|1015566|1015982|1016357|1016674|1017329|1017402|1017403|1017404|1017405|1017414|1017763|1017893|1018404|1018740|1021499|1021539|1022098|1022118|1022123|1022132|1022140|1022237|1022258|1022392|1022618|1022862|1022872|1022910|1022914|1022966|1022979|1022988|1022997|1023005|1023016|1023024|1023040|1023043|1023047|1023113|1023119|1023125|1023131|1023139|1023147|1023151|1023160|1023177|1023183|1023192|1023463|1024591|1024629|1024842|1025118|1025690|1026704|1026738|1027443|1027610|1029094|1029443|1029592|1029601|1029770|1030084|1030121|1031515|1034374|1034635|1035248|1036094|1036431|1036926|1037241|1039191|1041136|1041895|1042043|1042054|1042071|1042077|1042262|1042478|1043898|1045633|1048830|1052993|1053817|1054229|1056788|1057422|1057426|1058612|1058631|1058650|1059598|1061553|1064023|1064598|1064798|1068317|1069200|1070105|1076507|1080983|1083682|1098856|1099029|1099879|1103890|1141000|1179251|1207868|1212442|1234321|1234328|1234331|1234850|1235281|1235491|1235731|1238128|1242169|1244328|1244561|1245812|1250104|1251826|1252914|1253284|1256162|1262670|1275800|1275996|1277211|1277408|1278093|1280515|1280943|1284681|1284694|1284697|1293597|1293697|1317025|1318111|1330164|2088097|2088313|2089141|2100785|6679691|6737629|6776788|6777891|6793356|10783758|\n+-------+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+--------+\n|1000002|  1| 18| 28| 30| 59| 78| 82|101|106|121|202|228|231|237|238|242|250|313|344|357|360|388|393|395|402|407|421|478|532|542|553|599|600|606|619|648|657|658|666|668|671|672|688|691|709|715|719|721|723|725|733|735|740|742|758|776|782|793|831|833|860|893|930|949|958|969|976|979|988|999|1018|1024|1169|1171|1177|1183|1187|1194|1195|1196|1197|1198|1199|1200|1201|1204|1212|1223|1224|1226|1230|1251|1262|1263|1265|1270|1274|1289|1303|1305|1327|1330|1394|1399|1403|1410|1413|1414|1428|1441|1444|1448|1462|1495|1501|1516|1520|1570|1779|1789|1805|1825|1835|1844|1854|1858|1864|1890|1967|2077|2085|2167|2171|2184|2194|2600|2617|2621|2636|2712|2717|2823|2842|2860|2883|2884|2897|2916|2951|2955|3007|3009|3033|3083|3085|3122|3123|3150|3170|3197|3287|3292|3296|3314|3316|3321|3327|3328|3379|3402|3408|3418|3427|3437|3491|3547|3554|3625|3656|3677|3727|3902|3941|3985|4019|4083|4137|4154|4156|4195|4209|4221|4224|4241|4246|4250|4267|4324|4341|4371|4377|4468|4538|4567|4569|4775|5097|5153|5372|5376|5409|5452|5453|5496|5606|5626|5661|5668|5687|5702|5705|5712|5734|5761|1000006|1000007|1000009|1000010|1000013|1000014|1000017|1000024|1000025|1000028|1000031|1000033|   null|1000042|1000045|1000054|1000055|1000056|1000059|1000062|   null|   null|   null|   null|   null|1000088|   null|1000099|1000107|   null|   null|1000113|   null|1000123|   null|1000127|   null|   null|1000139|1000140|1000157|   null|   null|   null|   null|1000183|1000188|   null|1000201|   null|1000210|   null|   null|1000243|1000251|1000260|1000265|1000266|   null|1000283|   null|   null|1000288|1000289|1000293|1000295|   null|1000302|1000305|1000315|1000317|   null|1000322|1000323|1000325|   null|   null|   null|   null|1000340|   null|1000343|1000382|   null|   null|   null|   null|   null|   null|   null|   null|1000424|   null|   null|   null|1000434|   null|1000438|1000440|   null|   null|   null|   null|   null|1000450|1000451|   null|1000456|1000457|   null|   null|   null|   null|   null|1000481|   null|   null|1000498|1000503|   null|   null|1000515|1000518|1000520|1000522|   null|   null|   null|   null|   null|   null|   null|   null|   null|1000569|   null|   null|   null|   null|   null|   null|   null|   null|1000597|   null|   null|1000620|1000623|   null|1000625|1000630|1000631|1000632|   null|1000639|   null|   null|   null|   null|   null|   null|   null|1000660|1000674|1000676|1000677|   null|   null|   null|   null|   null|   null|   null|   null|1000716|   null|   null|1000724|1000726|1000727|1000730|1000737|1000738|1000740|1000744|1000751|   null|   null|1000761|1000762|   null|1000764|   null|1000766|1000768|1000773|   null|1000781|   null|   null|   null|   null|   null|   null|   null|   null|   null|   null|   null|   null|   null|   null|   null|1000840|   null|1000848|1000853|1000855|   null|1000874|   null|   null|   null|   null|1000904|   null|   null|1000931|1000933|   null|   null|   null|   null|   null|   null|   null|   null|   null|   null|   null|   null|   null|1000981|1000982|1000985|1001007|1001008|1001065|1001129|1001130|1001152|1001167|1001172|1001174|1001178|1001180|1001207|1001208|1001220|1001223|1001229|1001230|1001233|1001240|1001249|1001261|1001265|1001270|1001273|1001276|1001281|1001291|1001292|1001293|1001294|1001295|1001296|1001300|1001302|1001304|1001306|1001307|1001310|1001313|1001320|1001327|1001328|1001329|1001332|1001333|1001341|1001342|1001343|1001345|1001346|1001347|1001348|1001351|1001352|1001353|1001355|1001358|1001362|1001363|1001380|1001402|1001410|1001426|1001478|1001483|1001528|1001529|1001531|1001550|1001551|1001646|1001653|1001674|1001708|1001727|1001757|1001804|1001807|1001812|1001835|1001836|1001855|1001858|1001888|1001900|1001910|1001920|1001989|1002098|1002178|1002214|1002287|1002382|1002401|1002439|1002457|1002498|1002517|1002556|1002577|1002586|1002615|1002624|1002732|1002736|1002794|1002801|1002802|1002837|1002852|1002909|1002914|1002915|1002916|1003030|1003039|1003069|1003083|1003084|1003158|1003159|1003168|1003212|1003263|1003265|1003342|1003365|1003367|1003369|1003370|1003371|1003373|1003376|1003377|1003378|1003379|1003380|1003381|1003382|1003383|1003384|1003386|1003387|1003388|1003389|1003391|1003394|1003395|1003396|1003397|1003398|1003402|1003404|1003405|1003406|1003408|1003409|1003410|1003411|1003412|1003413|1003414|1003415|1003416|1003417|1003418|1003419|1003420|1003421|1003422|1003424|1003433|1003472|1003475|1003477|1003478|1003483|1003484|1003488|1003489|1003493|1003495|1003497|1003501|1003511|1003514|1003515|1003517|1003518|1003519|1003520|1003522|1003523|1003524|1003526|1003527|1003557|1003579|1003610|1003612|1003615|1003616|1003617|1003619|1003620|1003622|1003623|1003627|1003628|1003631|1003632|1003633|1003634|1003637|1003640|1003643|1003646|1003647|1003648|1003649|1003650|1003654|1003655|1003657|1003673|1003700|1003731|1003778|1003886|1003926|1003944|1003988|1003994|1004039|1004055|1004058|1004082|1004130|1004216|1004245|1004308|1004309|1004312|1004315|1004316|1004323|1004326|1004334|1004336|1004338|1004339|1004346|1004349|1004351|1004352|1004355|1004359|1004362|1004365|1004369|1004370|1004371|1004373|1004375|1004378|1004380|1004381|1004384|1004386|1004391|1004393|1004394|1004395|1004398|1004401|1004406|1004628|1004629|1004637|1005059|1005308|1005365|1005370|1005374|1005375|1005377|1005615|1005729|1005749|1005915|1005945|1006094|1006102|1006174|1006304|1006332|1006379|1006381|1006385|1006392|1006399|1006404|1006410|1006412|1006418|1006846|1006896|1007045|1007346|1007347|1007430|1007459|1007603|1007652|1007653|1007744|1007753|1007756|1007757|1007972|1008016|1008136|1008164|1008850|1009024|1009065|1009243|1009786|1009970|1010005|1010022|1010076|1010093|1010143|1010152|1010160|1010219|1010683|1011814|1012807|1014033|1014120|1014133|1014421|1014463|1014481|1015265|1015566|1015982|1016357|1016674|1017329|1017402|1017403|1017404|1017405|1017414|1017763|1017893|1018404|1018740|1021499|1021539|1022098|1022118|1022123|1022132|1022140|1022237|1022258|1022392|1022618|1022862|1022872|1022910|1022914|1022966|1022979|1022988|1022997|1023005|1023016|1023024|1023040|1023043|1023047|1023113|1023119|1023125|1023131|1023139|1023147|1023151|1023160|1023177|1023183|1023192|1023463|1024591|1024629|1024842|1025118|1025690|1026704|1026738|1027443|1027610|1029094|1029443|1029592|1029601|1029770|1030084|1030121|1031515|1034374|1034635|1035248|1036094|1036431|1036926|1037241|1039191|1041136|1041895|1042043|1042054|1042071|1042077|1042262|1042478|1043898|1045633|1048830|1052993|1053817|1054229|1056788|1057422|1057426|1058612|1058631|1058650|1059598|1061553|1064023|1064598|1064798|1068317|1069200|1070105|1076507|1080983|1083682|1098856|1099029|1099879|1103890|1141000|1179251|1207868|1212442|1234321|1234328|1234331|1234850|1235281|1235491|1235731|1238128|1242169|1244328|1244561|1245812|1250104|1251826|1252914|1253284|1256162|1262670|1275800|1275996|1277211|1277408|1278093|1280515|1280943|1284681|1284694|1284697|1293597|1293697|1317025|1318111|1330164|2088097|2088313|2089141|2100785|6679691|6737629|6776788|6777891|6793356|10783758|\n+-------+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+--------+\nonly showing top 1 row\n\nuserArtistSubsetDF: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [user: int, artist: int ... 1 more field]\ntransactions: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [user: int, 1: int ... 973 more fields]\n"}]},"apps":[],"jobName":"paragraph_1590750679022_-471068489","id":"20200529-111119_479192922","dateCreated":"2020-05-29T11:11:19+0000","dateStarted":"2020-06-04T11:18:24+0000","dateFinished":"2020-06-04T11:19:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:282","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=3","http://172.17.0.2:4040/jobs/job?id=4"],"interpreterSettingId":"spark"}}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1591269421271_-968799458","id":"20200604-111701_1275696036","dateCreated":"2020-06-04T11:17:01+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2004","text":"%md\n### Preprocessing on transactions","dateUpdated":"2020-06-04T11:19:38+0000","dateFinished":"2020-06-04T11:19:38+0000","dateStarted":"2020-06-04T11:19:38+0000","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Preprocessing on transactions</h3>\n</div>"}]}},{"text":"%spark\ntransactions.createOrReplaceTempView(\"transactions\")\nval transaction_dropped = transactions.drop(\"user\")\ntransaction_dropped.createOrReplaceTempView(\"transactions_dropped\")\n\nval combined = transactions.withColumn(\"items\", concat_ws(\",\",transaction_dropped.columns.map(collist => col(collist)): _*))\nval columnNames = Seq(\"user\", \"items\")\nval transactions_formatted = combined.select(columnNames.head, columnNames.tail:_*)\n// transform items into array type\nval transactions_array = transactions_formatted.withColumn(\"items\", split(col(\"items\"), \",\").cast(\"array<long>\"))\ntransactions_array.show(2)","user":"anonymous","dateUpdated":"2020-06-04T11:23:34+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","editorHide":false,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1591269446270_-956204560","id":"20200604-111726_14925972","dateCreated":"2020-06-04T11:17:26+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2108","dateFinished":"2020-06-04T11:23:37+0000","dateStarted":"2020-06-04T11:23:34+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+--------------------+\n|   user|               items|\n+-------+--------------------+\n|1000002|[1, 18, 28, 30, 5...|\n|1000019|[1000010, 1000028...|\n+-------+--------------------+\n\ntransaction_dropped: org.apache.spark.sql.DataFrame = [1: int, 18: int ... 972 more fields]\ncombined: org.apache.spark.sql.DataFrame = [user: int, 1: int ... 974 more fields]\ncolumnNames: Seq[String] = List(user, items)\ntransactions_formatted: org.apache.spark.sql.DataFrame = [user: int, items: string]\ntransactions_array: org.apache.spark.sql.DataFrame = [user: int, items: array<bigint>]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=12"],"interpreterSettingId":"spark"}}},{"text":"%md\n## Create FPGrowth model for frequent pattern mining","user":"anonymous","dateUpdated":"2020-06-04T11:00:39+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Create FPGrowth model for frequent pattern mining</h2>\n</div>"}]},"apps":[],"jobName":"paragraph_1590750858376_995039256","id":"20200529-111418_2096367753","dateCreated":"2020-05-29T11:14:18+0000","dateStarted":"2020-06-04T11:00:39+0000","dateFinished":"2020-06-04T11:00:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:283"},{"text":"val fpgrowth = new FPGrowth().setItemsCol(\"items\").setMinSupport(0.1).setMinConfidence(0.1)\nval model = fpgrowth.fit(transactions_array)\n/*\nval transactionsRDD = transactions.map{x:Row => x.getAs[List](0)}\nval transactionsRDD = transactions.rdd\nval fpg = new FPGrowth().setMinSupport(0.1)\nval model = fpg.run(transactionsRDD)\n*/\n","user":"anonymous","dateUpdated":"2020-06-04T11:34:03+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"fpgrowth: org.apache.spark.ml.fpm.FPGrowth = fpgrowth_ea163d872515\nmodel: org.apache.spark.ml.fpm.FPGrowthModel = fpgrowth_ea163d872515\n"}]},"apps":[],"jobName":"paragraph_1590750880281_-470861645","id":"20200529-111440_895362572","dateCreated":"2020-05-29T11:14:40+0000","dateStarted":"2020-06-04T11:34:03+0000","dateFinished":"2020-06-04T11:34:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:284","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=13","http://172.17.0.2:4040/jobs/job?id=14"],"interpreterSettingId":"spark"}}},{"text":"%md\n## Frequent items sets","user":"anonymous","dateUpdated":"2020-06-04T10:49:40+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Frequent items sets</h2>\n</div>"}]},"apps":[],"jobName":"paragraph_1590936910680_753181140","id":"20200531-145510_333750401","dateCreated":"2020-05-31T14:55:10+0000","dateStarted":"2020-06-04T10:49:40+0000","dateFinished":"2020-06-04T10:49:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:285"},{"text":"\nmodel.freqItemsets.show()\n// Display generated association\n//model.generateAssociationRules().show()\n// transform examines the input items against all the association rules and summarize the consequents as prediction\n// model.transform(itemsDF).show()","user":"anonymous","dateUpdated":"2020-06-04T11:01:58+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"java.net.SocketException: Broken pipe (Write failed)\n\tat java.net.SocketOutputStream.socketWrite0(Native Method)\n\tat java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:111)\n\tat java.net.SocketOutputStream.write(SocketOutputStream.java:155)\n\tat java.io.BufferedOutputStream.flushBuffer(BufferedOutputStream.java:82)\n\tat java.io.BufferedOutputStream.write(BufferedOutputStream.java:126)\n\tat org.apache.thrift.transport.TIOStreamTransport.write(TIOStreamTransport.java:145)\n\tat org.apache.thrift.protocol.TBinaryProtocol.writeString(TBinaryProtocol.java:202)\n\tat org.apache.zeppelin.interpreter.thrift.RemoteInterpreterContext$RemoteInterpreterContextStandardScheme.write(RemoteInterpreterContext.java:1228)\n\tat org.apache.zeppelin.interpreter.thrift.RemoteInterpreterContext$RemoteInterpreterContextStandardScheme.write(RemoteInterpreterContext.java:1074)\n\tat org.apache.zeppelin.interpreter.thrift.RemoteInterpreterContext.write(RemoteInterpreterContext.java:956)\n\tat org.apache.zeppelin.interpreter.thrift.RemoteInterpreterService$interpret_args$interpret_argsStandardScheme.write(RemoteInterpreterService.java:6781)\n\tat org.apache.zeppelin.interpreter.thrift.RemoteInterpreterService$interpret_args$interpret_argsStandardScheme.write(RemoteInterpreterService.java:6704)\n\tat org.apache.zeppelin.interpreter.thrift.RemoteInterpreterService$interpret_args.write(RemoteInterpreterService.java:6631)\n\tat org.apache.thrift.TServiceClient.sendBase(TServiceClient.java:63)\n\tat org.apache.zeppelin.interpreter.thrift.RemoteInterpreterService$Client.send_interpret(RemoteInterpreterService.java:268)\n\tat org.apache.zeppelin.interpreter.thrift.RemoteInterpreterService$Client.interpret(RemoteInterpreterService.java:257)\n\tat org.apache.zeppelin.interpreter.remote.RemoteInterpreter$4.call(RemoteInterpreter.java:233)\n\tat org.apache.zeppelin.interpreter.remote.RemoteInterpreter$4.call(RemoteInterpreter.java:229)\n\tat org.apache.zeppelin.interpreter.remote.RemoteInterpreterProcess.callRemoteFunction(RemoteInterpreterProcess.java:135)\n\tat org.apache.zeppelin.interpreter.remote.RemoteInterpreter.interpret(RemoteInterpreter.java:228)\n\tat org.apache.zeppelin.notebook.Paragraph.jobRun(Paragraph.java:437)\n\tat org.apache.zeppelin.scheduler.Job.run(Job.java:188)\n\tat org.apache.zeppelin.scheduler.RemoteScheduler$JobRunner.run(RemoteScheduler.java:315)\n\tat java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)\n\tat java.util.concurrent.FutureTask.run(FutureTask.java:266)\n\tat java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)\n\tat java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\n\tat java.lang.Thread.run(Thread.java:748)\n"}]},"apps":[],"jobName":"paragraph_1591267780338_1292045914","id":"20200604-104940_1657700352","dateCreated":"2020-06-04T10:49:40+0000","dateStarted":"2020-06-04T10:55:12+0000","dateFinished":"2020-06-04T10:55:12+0000","status":"ERROR","errorMessage":"java.net.SocketException: Broken pipe (Write failed)\n\tat java.net.SocketOutputStream.socketWrite0(Native Method)\n\tat java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:111)\n\tat java.net.SocketOutputStream.write(SocketOutputStream.java:155)\n\tat java.io.BufferedOutputStream.flushBuffer(BufferedOutputStream.java:82)\n\tat java.io.BufferedOutputStream.write(BufferedOutputStream.java:126)\n\tat org.apache.thrift.transport.TIOStreamTransport.write(TIOStreamTransport.java:145)\n\tat org.apache.thrift.protocol.TBinaryProtocol.writeString(TBinaryProtocol.java:202)\n\tat org.apache.zeppelin.interpreter.thrift.RemoteInterpreterContext$RemoteInterpreterContextStandardScheme.write(RemoteInterpreterContext.java:1228)\n\tat org.apache.zeppelin.interpreter.thrift.RemoteInterpreterContext$RemoteInterpreterContextStandardScheme.write(RemoteInterpreterContext.java:1074)\n\tat org.apache.zeppelin.interpreter.thrift.RemoteInterpreterContext.write(RemoteInterpreterContext.java:956)\n\tat org.apache.zeppelin.interpreter.thrift.RemoteInterpreterService$interpret_args$interpret_argsStandardScheme.write(RemoteInterpreterService.java:6781)\n\tat org.apache.zeppelin.interpreter.thrift.RemoteInterpreterService$interpret_args$interpret_argsStandardScheme.write(RemoteInterpreterService.java:6704)\n\tat org.apache.zeppelin.interpreter.thrift.RemoteInterpreterService$interpret_args.write(RemoteInterpreterService.java:6631)\n\tat org.apache.thrift.TServiceClient.sendBase(TServiceClient.java:63)\n\tat org.apache.zeppelin.interpreter.thrift.RemoteInterpreterService$Client.send_interpret(RemoteInterpreterService.java:268)\n\tat org.apache.zeppelin.interpreter.thrift.RemoteInterpreterService$Client.interpret(RemoteInterpreterService.java:257)\n\tat org.apache.zeppelin.interpreter.remote.RemoteInterpreter$4.call(RemoteInterpreter.java:233)\n\tat org.apache.zeppelin.interpreter.remote.RemoteInterpreter$4.call(RemoteInterpreter.java:229)\n\tat org.apache.zeppelin.interpreter.remote.RemoteInterpreterProcess.callRemoteFunction(RemoteInterpreterProcess.java:135)\n\tat org.apache.zeppelin.interpreter.remote.RemoteInterpreter.interpret(RemoteInterpreter.java:228)\n\tat org.apache.zeppelin.notebook.Paragraph.jobRun(Paragraph.java:437)\n\tat org.apache.zeppelin.scheduler.Job.run(Job.java:188)\n\tat org.apache.zeppelin.scheduler.RemoteScheduler$JobRunner.run(RemoteScheduler.java:315)\n\tat java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)\n\tat java.util.concurrent.FutureTask.run(FutureTask.java:266)\n\tat java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)\n\tat java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\n\tat java.lang.Thread.run(Thread.java:748)\n","progressUpdateIntervalMs":500,"$$hashKey":"object:286"},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1591268078316_1058846978","id":"20200604-105438_1198090082","dateCreated":"2020-06-04T10:54:38+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:287"}],"name":"MBA_audioscrobbler","id":"2F9SCURCS","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}